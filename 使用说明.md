# 工资Excel导入工具使用说明

## 快速开始

### 1. 安装依赖
```bash
pip install pandas openpyxl
```

### 2. 准备Excel文件
使用提供的 `salary_template.xlsx` 作为模板，或按照以下格式创建Excel文件：

**必需列：**
- 员工ID（必须在系统中存在）
- 年份
- 月份  
- 基础工资（必须大于0）

**可选列：**
- 岗位工资、绩效工资、加班费、奖金、津贴、扣除、发放日期

### 3. 运行导入
```bash
python import_salary_excel.py your_file.xlsx
```

## 支持的Excel格式

### 中文列名示例
```
员工ID | 年份 | 月份 | 基础工资 | 岗位工资 | 绩效工资 | 加班费 | 奖金 | 津贴 | 扣除
EMP001 | 2024 | 3   | 5000    | 1000    | 800     | 500   | 1000 | 0   | 100
```

### 英文列名示例
```
employee_id | year | month | base_salary | position_salary | performance_salary | overtime_pay | bonus | allowance | deduction
EMP001      | 2024 | 3     | 5000        | 1000           | 800               | 500         | 1000  | 0         | 100
```

## 注意事项

1. **员工ID必须存在**：确保Excel中的员工ID在数据库中已存在
2. **基础工资必填**：基础工资不能为空或0
3. **重复记录**：如果某员工某月记录已存在，会自动更新
4. **总工资自动计算**：如果未提供总工资，系统会自动计算

## 常见问题

**Q: 提示"员工ID不存在"怎么办？**
A: 检查Excel中的员工ID是否与数据库中的employee_id完全匹配

**Q: 导入后在网页上看不到数据？**
A: 刷新浏览器页面，或检查筛选条件（年份、月份、部门）

**Q: 可以导入历史数据吗？**
A: 可以，只需在Excel中设置对应的年份和月份

## 示例文件

项目中提供了以下示例文件：
- `salary_template.xlsx` - Excel模板文件
- `salary_template.csv` - CSV格式模板

直接使用这些模板文件测试导入功能。