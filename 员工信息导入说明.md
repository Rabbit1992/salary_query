# 员工信息Excel导入工具使用说明

## 快速开始

### 1. 安装依赖
```bash
pip install pandas openpyxl
```

### 2. 准备Excel文件

**必需列：**
- 员工ID（如：EMP001）
- 姓名（如：张三）
- 部门（如：技术部）
- 职位（如：软件工程师）

**可选列：**
- 用户名（默认使用员工ID）
- 密码（默认：123456）
- 入职日期（默认：今天）
- 角色（默认：employee，可选：admin）

### 3. 运行导入
```bash
python import_employee_excel.py 你的员工文件.xlsx
```

## Excel格式示例

| 员工ID | 用户名 | 密码 | 姓名 | 部门 | 职位 | 入职日期 | 角色 |
|--------|--------|------|------|------|------|----------|------|
| EMP001 | zhang.san | 123456 | 张三 | 技术部 | 软件工程师 | 2024-01-15 | employee |
| EMP002 | li.si | 123456 | 李四 | 人事部 | 人事专员 | 2024-02-01 | employee |
| EMP003 | admin | admin123 | 管理员 | 管理层 | 系统管理员 | 2024-01-01 | admin |

## 注意事项

✅ **支持的功能：**
- 自动检测重复员工ID和用户名
- 密码自动加密存储
- 支持中英文列名
- 灵活的日期格式
- 默认值自动填充

⚠️ **重要提醒：**
- 员工ID和用户名必须唯一
- 姓名、部门、职位不能为空
- 当前只支持新增，不支持更新现有员工
- 建议导入前备份数据库

## 示例文件

系统已为您准备了示例文件：`employee_template.xlsx`

您可以直接修改此文件来准备自己的员工数据。

## 常见错误

- **"员工ID已存在"** → 检查是否有重复的员工ID
- **"用户名已存在"** → 检查是否有重复的用户名
- **"姓名不能为空"** → 确保每行都有员工姓名
- **"部门不能为空"** → 确保每行都有部门信息
- **"职位不能为空"** → 确保每行都有职位信息

## 成功示例

```
==================================================
员工信息Excel数据导入工具
==================================================
成功连接到数据库：server/database/salary.db
找到 4 个现有员工记录
成功读取Excel文件：employee_template.xlsx
数据行数：5

成功处理 1 条记录
新增员工：EMP005 - 赵六 (销售部/销售经理)

==================================================
导入结果统计
==================================================
成功导入：1 条记录
导入失败：0 条记录

✅ 导入完成！
```