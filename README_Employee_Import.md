# 员工信息Excel导入工具使用说明

## 功能概述

本工具用于将Excel格式的员工信息批量导入到系统数据库中，支持新员工信息的添加和数据验证。

## 安装依赖

在使用前，请确保已安装必要的Python包：

```bash
pip install pandas openpyxl
```

## 使用方法

### 基本用法

```bash
python import_employee_excel.py <Excel文件路径>
```

### 指定数据库路径

```bash
python import_employee_excel.py <Excel文件路径> --db <数据库路径>
```

## Excel文件格式要求

### 必需列（必须包含）

| 列名（中文） | 列名（英文） | 说明 | 示例 |
|-------------|-------------|------|------|
| 员工ID | employee_id | 唯一员工标识 | EMP001 |
| 姓名 | name | 员工姓名 | 张三 |
| 部门 | department | 所属部门 | 技术部 |
| 职位 | position | 工作职位 | 软件工程师 |

### 可选列（可以省略）

| 列名（中文） | 列名（英文） | 说明 | 默认值 | 示例 |
|-------------|-------------|------|--------|------|
| 用户名 | username | 登录用户名 | 使用员工ID | zhang.san |
| 密码 | password | 登录密码 | 123456 | mypassword |
| 入职日期 | join_date | 入职时间 | 当前日期 | 2024-01-15 |
| 角色 | role | 用户权限 | employee | admin/employee |

## 支持的Excel格式示例

### 示例1：完整信息（中文列名）

| 员工ID | 用户名 | 密码 | 姓名 | 部门 | 职位 | 入职日期 | 角色 |
|--------|--------|------|------|------|------|----------|------|
| EMP001 | zhang.san | 123456 | 张三 | 技术部 | 软件工程师 | 2024-01-15 | employee |
| EMP002 | li.si | 123456 | 李四 | 人事部 | 人事专员 | 2024-02-01 | employee |
| EMP003 | admin | admin123 | 管理员 | 管理层 | 系统管理员 | 2024-01-01 | admin |

### 示例2：最简信息（只包含必需列）

| 员工ID | 姓名 | 部门 | 职位 |
|--------|------|------|------|
| EMP004 | 王五 | 财务部 | 会计 |
| EMP005 | 赵六 | 销售部 | 销售经理 |

### 示例3：英文列名

| employee_id | username | name | department | position | join_date | role |
|-------------|----------|------|------------|----------|-----------|------|
| EMP006 | chen.qi | 陈七 | 市场部 | 市场专员 | 2024-03-01 | employee |

## 数据验证规则

### 必填字段验证
- **员工ID**：不能为空，且不能与现有员工重复
- **姓名**：不能为空
- **部门**：不能为空
- **职位**：不能为空

### 唯一性验证
- **员工ID**：系统中必须唯一
- **用户名**：系统中必须唯一

### 数据处理规则
- **用户名**：如果未提供，自动使用员工ID作为用户名
- **密码**：如果未提供，默认设置为"123456"，导入时会自动进行哈希加密
- **入职日期**：如果未提供，默认为当前日期
- **角色**：如果未提供或值无效，默认为"employee"，支持"admin"和"employee"两种角色

## 注意事项

1. **文件格式**：支持.xlsx和.xls格式的Excel文件
2. **编码支持**：支持中文字符，建议使用UTF-8编码
3. **数据备份**：导入前建议备份现有数据库
4. **重复数据**：系统会自动检测并跳过重复的员工ID和用户名
5. **密码安全**：所有密码在导入时会自动进行SHA256哈希加密存储
6. **日期格式**：支持多种日期格式，如"2024-01-15"、"2024/1/15"等

## 常见问题解答

### Q: 导入时提示"员工ID已存在"怎么办？
A: 这表示该员工ID在系统中已经存在。请检查Excel文件中的员工ID是否正确，或者使用不同的员工ID。

### Q: 可以更新现有员工信息吗？
A: 当前版本只支持新增员工，不支持更新现有员工信息。如需更新，请先删除现有记录再重新导入。

### Q: 支持哪些日期格式？
A: 支持常见的日期格式，如：
- 2024-01-15
- 2024/1/15
- 2024年1月15日
- Excel日期格式

### Q: 角色字段支持哪些值？
A: 目前支持两种角色：
- **admin**：管理员权限
- **employee**：普通员工权限（默认）

### Q: 导入失败了怎么办？
A: 请检查：
1. Excel文件路径是否正确
2. 文件是否包含必需的列
3. 数据库文件是否存在且可访问
4. 是否有重复的员工ID或用户名

## 示例文件

系统提供了示例文件 `employee_template.xlsx`，包含了正确的格式和示例数据，您可以参考此文件准备自己的员工数据。

## 技术支持

如果在使用过程中遇到问题，请检查：
1. Python环境是否正确安装
2. 必要的依赖包是否已安装
3. Excel文件格式是否符合要求
4. 数据库文件是否存在且有写入权限